id: CASE-002
description: >
  FÃ¼hre einen JOIN zwischen ACCOUNTS und CUSTOMERS durch; caste CHAR IDs zu INT.
  Erkenne Typinkonsistenzen und deren Risiken.
input_tables:
  ACCOUNTS:
    columns:
      - {name: ACCOUNT_ID, type: CHAR(10)}
      - {name: CUSTOMER_ID, type: CHAR(10)}
  CUSTOMERS:
    columns:
      - {name: CUSTOMER_ID, type: INT}
      - {name: SEGMENT, type: VARCHAR(20)}
  TARGET:
    columns:
      - {name: ACCOUNT_ID, type: INT}
      - {name: CUSTOMER_ID, type: INT}
      - {name: SEGMENT, type: VARCHAR(20)}
sql_script: |
  INSERT INTO TARGET (ACCOUNT_ID, CUSTOMER_ID, SEGMENT)
  SELECT
    CAST(a.ACCOUNT_ID AS INT) AS ACCOUNT_ID,
    CAST(a.CUSTOMER_ID AS INT) AS CUSTOMER_ID,
    c.SEGMENT
  FROM ACCOUNTS a
  LEFT JOIN CUSTOMERS c ON CAST(a.CUSTOMER_ID AS INT) = c.CUSTOMER_ID
  WHERE a.CUSTOMER_ID IS NOT NULL;
focus: "JOIN-Keys, Casting CHAR->INT, Null-Handling"
