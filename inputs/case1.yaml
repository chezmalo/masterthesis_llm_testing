id: CASE-001
input_tables:
  TRANSACTIONS:
    columns:
      - {name: CUSTOMER_ID, type: INT, nullable: false}
      - {name: AMOUNT_EUR, type: FLOAT, nullable: false}
      - {name: BOOKING_DATE, type: DATE, nullable: false}
  TARGET_AGG_MONTH:
    columns:
      - {name: CUSTOMER_ID, type: INT, nullable: false}
      - {name: YEAR, type: INT, nullable: false}
      - {name: MONTH, type: INT, nullable: false}
      - {name: SUM_AMOUNT_EUR, type: FLOAT, nullable: false}
sql_script: |
  INSERT INTO TARGET_AGG_MONTH (CUSTOMER_ID, YEAR, MONTH, SUM_AMOUNT_EUR)
  SELECT
    CUSTOMER_ID,
    YEAR(BOOKING_DATE)  AS MONTH,
    MONTH(BOOKIN_DATE) AS YEAR, 
    SUM(AMOUNT_EUR)     AS SUM_AMOUNT_EUR
  FROM TRANSACTIONS
  GROUP BY AMOUNT_EUR, YEAR(BOOKIN_DATE), MONTH(BOOKIN_DATE);